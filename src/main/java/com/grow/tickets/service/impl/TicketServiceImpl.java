package com.grow.tickets.service.impl;import com.grow.tickets.dao.TicketDAO;import com.grow.tickets.data.Ticket;import com.grow.tickets.enums.TimePoint;import com.grow.tickets.exception.GeneratedException;import com.grow.tickets.service.TicketService;import com.grow.tickets.util.Util;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import java.util.HashMap;import java.util.Map;public abstract class TicketServiceImpl implements TicketService {    private static final Logger logger = LoggerFactory.getLogger(TicketServiceImpl.class);    private static final String BUYER_FOR_ERROR = "exception";    @Override    public Ticket sellTicket(String buyer) {        Ticket ticket = getTicketDAO().getLastFree().get();        logger.info("Buyer " + buyer+ ", Get ticket #" + ticket.getId());        ticket.setBuyer(buyer);        getTicketDAO().setTicket(ticket);        if (BUYER_FOR_ERROR.equals(buyer)){            Util.pause(5000);            throw new GeneratedException();        }        logger.info("Buyer " + buyer + " SAVED");        return ticket;    }    @Override    public Map<TimePoint, Long> getCountSold() {        Map<TimePoint, Long> result = new HashMap<>();        result.put(TimePoint.START, getTicketDAO().getCountSold());        //  pause to check the isolation levels        Util.pause(6000);        result.put(TimePoint.FINISH, getTicketDAO().getCountSold());        return result;    }    @Override    public Map<TimePoint, Long> getCountFree() {        Map<TimePoint, Long> result = new HashMap<>();        result.put(TimePoint.START, getTicketDAO().getCountFree());        //  pause to check the isolation levels        Util.pause(6000);        result.put(TimePoint.FINISH, getTicketDAO().getCountFree());        return result;    }    @Override    public Ticket addFreeTicket() {        Ticket ticket = new Ticket();        return getTicketDAO().setTicket(ticket);    }    protected abstract TicketDAO getTicketDAO();}